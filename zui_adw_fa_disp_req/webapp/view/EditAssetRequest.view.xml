<mvc:View xmlns:mvc="sap.ui.core.mvc"
    xmlns:uxap="sap.uxap"
    xmlns:c="sap.ui.core"
    xmlns="sap.ui.table"
    xmlns:layout="sap.ui.layout"
    xmlns:rowmodes="sap.ui.table.rowmodes"
    xmlns:m="sap.m" controllerName="zui.adw.fixedassetsdisposalapproval.zuiadwfadispreq.controller.EditAssetRequest">
    <uxap:ObjectPageLayout id="ObjectPageLayout" showFooter="true">
        <uxap:headerTitle>
            <uxap:ObjectPageDynamicHeaderTitle>
                <uxap:expandedHeading>
                    <m:Title text="{= ${i18n>lblBtpRequestId}+': '+ ${listOfSelectedAssetsModel>/Header/RequestId}}" />
                </uxap:expandedHeading>
                <uxap:expandedContent>
                    <layout:VerticalLayout>
                        <m:ObjectStatus title="{i18n>colCompanyCode}" text="{listOfSelectedAssetsModel>/Header/CompanyCode}" />
                        <m:ObjectStatus title="{i18n>lblStatus}" text="{listOfSelectedAssetsModel>/Header/Status}" />
                    </layout:VerticalLayout>
                </uxap:expandedContent>
            </uxap:ObjectPageDynamicHeaderTitle>
        </uxap:headerTitle>
        <uxap:sections>
            <uxap:ObjectPageSection showTitle="false">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <Table id="idtEditAssetRequest" rows="{listOfSelectedAssetsModel>/Items}" selectionMode="None" fixedColumnCount="2">
                                <extension>
                                    <m:OverflowToolbar style="Clear">
                                        <m:Title id="idtitle" text="{i18n>titleSelectedAssets}" />
                                    </m:OverflowToolbar>
                                </extension>
                                <rowMode>
                                    <rowmodes:Auto maxRowCount="{listOfSelectedAssetsModel>/length}" />
                                </rowMode>
                                <columns>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblCompanyCode}" />
                                        <template>
                                            <m:Text text="{listOfSelectedAssetsModel>Bukrs}" wrapping="false" />
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblAsset}" />
                                        <template>
                                            <m:Text text="{listOfSelectedAssetsModel>Anln1}" />
                                        </template>
                                    </Column>
                                    <Column width="6rem" hAlign="End">
                                        <m:Label text="{i18n>lblAssetSub}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Anln2}" />
                                        </template>
                                    </Column>
                                    <Column width="9rem">
                                        <m:Label text="{i18n>lblAssetClass}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Anlkl}" />
                                        </template>
                                    </Column>
                                    <Column width="9rem">
                                        <m:Label text="{i18n>lblDescription}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Txa50Nlt}" />
                                        </template>
                                    </Column>
                                    <Column width="12rem">
                                        <m:Label text="{i18n>lblQuantity}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>AmMenge}" />
                                        </template>
                                    </Column>
                                    <Column width="9rem">
                                        <m:Label text="{i18n>lblBaseUnit}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Meins}" />
                                        </template>
                                    </Column>
                                    <Column width="9rem">
                                        <m:Label text="{i18n>lblAssetCapitalizationDate}" />
                                        <template>
                                            <!-- <m:Label text="{path: 'listOfSelectedAssetsModel>Aktivd', type: 'sap.ui.model.odata.type.Date' }" /> -->
                                            <m:Label text="{
            path: 'listOfSelectedAssetsModel>Aktivd',
            formatter: '.formatCapitalizationDate'
        }" />
                                        </template>
                                    </Column>
                                    <Column width="7rem">
                                        <m:Label text="{i18n>lblGroup1AssetEvalKey}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Ord41}" />
                                        </template>
                                    </Column>
                                    <Column width="12rem">
                                        <m:Label text="{i18n>lblGroup2AssetEvalKey}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Ord42}" />
                                        </template>
                                    </Column>
                                    <Column width="12rem">
                                        <m:Label text="{i18n>lblAssetLocation}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Stort}" />
                                        </template>
                                    </Column>
                                    <Column width="6rem">
                                        <m:Label text="{i18n>lblCostCenter}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Kostl}" />
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblWBSElement}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>PsPspPnr2}" />
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblProfitCenter}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Prctr}" />
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblGrantID}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>GmGrantNbr}" />
                                        </template>
                                    </Column>

                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblValidityEndDate}" />
                                        <template>
                                            <!-- <m:Label text="{path: 'listOfSelectedAssetsModel>GmToDate', type: 'sap.ui.model.odata.type.Date'}" /> -->
                                            <m:Label text="{
            path: 'listOfSelectedAssetsModel>GmToDate',
            formatter: '.formatCapitalizationDate'
        }" />

                                            <!-- <m:Label text="{
    parts: [
        { path: 'listOfSelectedAssetsModel>GmToDate' },
        { path: 'listOfSelectedAssetsModel>GmGrantNbr' }
    ],
    formatter: '.formatCapitalizationDate'
}" /> -->
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblAPCValue}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Answl}" />
                                        </template>
                                    </Column>

                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblCurrency}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Currency}" />
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblDepreTillDate}" />
                                        <template>
                                            <m:Label text="{listOfSelectedAssetsModel>Nafag}" />
                                        </template>
                                    </Column>
                                    <Column width="18rem">
                                        <m:Label text="{i18n>lblAssetPhysicalDisposalRequired}" required="true" />
                                        <template>
                                            <m:ComboBox editable="false" selectedKey="{listOfSelectedAssetsModel>Zphya}" change=".onEditDisposalRequiredChange" items="{disposalRequiredModel>/DisposalRequiredOptions}">
                                                <c:Item key="{disposalRequiredModel>key}" text="{disposalRequiredModel>text}" />
                                            </m:ComboBox>
                                        </template>
                                    </Column>
                                    <Column width="12rem">
                                        <m:Label text="{i18n>lblDisposalReason}" required="true" />
                                        <template>
                                            <m:ComboBox selectedKey="{listOfSelectedAssetsModel>Rstgr}" editable="{= ${listOfSelectedAssetsModel>/Header/Status}.includes('Rejected') || ${listOfSelectedAssetsModel>/Header/Status} === 'Save As Draft' }" items="{path: '/ReasonCodes',  sorter: {
                            path: 'Txt40',
                            descending: false},
		                                            filters: [{path: 'Btpdevid', operator: 'EQ', value1: 'FA-BTP-001'}]}">
                                                <c:Item key="{Rstgr}" text="{Txt40}" />
                                            </m:ComboBox>
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblDisposalQty}" />
                                        <template>
                                            <m:Input value="{listOfSelectedAssetsModel>Menge}" type="Number" editable="{= ${listOfSelectedAssetsModel>AmMenge}>0? true:false}" />
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblDisposalValue}" />
                                        <template>
                                            <m:Input value="{listOfSelectedAssetsModel>Anbtr}" change=".onDisposaValueChange" type="Number" editable="{= ${listOfSelectedAssetsModel>AmMenge}>0? false : true}" />
                                        </template>
                                    </Column>
                                    <Column width="11rem">
                                        <m:Label text="{i18n>lblDisposalPercentage}" />
                                        <template>
                                            <m:Input value="{listOfSelectedAssetsModel>Prozs}" change=".onDisposalPercentageChange" type="Number" editable="{= ${listOfSelectedAssetsModel>AmMenge}>0? false:true}" />
                                        </template>
                                    </Column>
                                    <Column width="18rem">
                                        <m:Label text="{i18n>lblProofOfDisposalAttachment}" />
                                        <template>
                                            <m:HBox justifyContent="SpaceBetween" alignItems="Center">
                                                <m:List items="{listOfSelectedAssetsModel>Attachments}">
                                                    <m:CustomListItem>
                                                        <m:HBox justifyContent="SpaceBetween" alignItems="Center" width="17rem">
                                                            <m:Link text="{= ${listOfSelectedAssetsModel>Filename}.length > 10 ? ${listOfSelectedAssetsModel>Filename}.substring(0, 10) + '...' : ${listOfSelectedAssetsModel>Filename}}" wrapping="true" press=".onDownloadItem" />
                                                            <m:Button class="sapUiMediumMarginBegin" icon="sap-icon://delete" type="Reject" press=".onDeleteAttachment" tooltip="{i18n>tooltipDeleteAttachment}" />
                                                        </m:HBox>
                                                    </m:CustomListItem>
                                                </m:List>
                                                <m:Button icon="sap-icon://upload" type="Transparent" press=".onAttachmentPress" tooltip="{i18n>tooltipUploadAttachment}" visible="{= ${listOfSelectedAssetsModel>Attachments}.length === 0}" />
                                            </m:HBox>
                                        </template>
                                    </Column>
                                </columns>
                            </Table>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
        </uxap:sections>
        <uxap:footer>
            <m:OverflowToolbar>
                <m:ToolbarSpacer />
                <m:Button text="{i18n>btnSaveDraft}" type="Emphasized" press=".onEditSaveDraftPress" enabled="{= ${listOfSelectedAssetsModel>/Header/Status}.includes('Rejected') || ${listOfSelectedAssetsModel>/Header/Status} === 'Save As Draft' }" />
                <m:Button text="{i18n>btnSubmit}" type="Accept" press=".onEditSubmitPress" enabled="{= ${listOfSelectedAssetsModel>/Header/Status}.includes('Rejected') || ${listOfSelectedAssetsModel>/Header/Status} === 'Save As Draft' }" />
                <m:Button text="{i18n>btnCancel}" type="Reject" press=".onEditCancelPress" enabled="{= ${listOfSelectedAssetsModel>/Header/Status}.includes('Rejected') || ${listOfSelectedAssetsModel>/Header/Status} === 'Save As Draft' }" />
            </m:OverflowToolbar>
        </uxap:footer>
    </uxap:ObjectPageLayout>
</mvc:View>
